import{r as a,P as i,j as e,D as I,c as x,B as v,O as L,a5 as E,d as f,z as F,e as M,a6 as N,L as w,R as C,p as b,T as P,Y as T,C as W,a as q,h as G}from"./index-345a54fd.js";import{P as U}from"./Plus-2c210ce3.js";import{c as V}from"./index-a56853d9.js";import{S as _}from"./seo-ea61f518.js";import{u as $}from"./use-page-view-43790c32.js";import{u as z}from"./use-update-effect-d9f6f2b5.js";import{T as H,a as Q}from"./Tabs-f33c10ba.js";import{A as Y}from"./ArrowRight-2bc513d7.js";import{E as J}from"./Edit02-74dfa7a1.js";import{T as K,a as D,b as o,c as X}from"./TableRow-8f2ec0b0.js";import{T as Z}from"./TableHead-fa724656.js";import{T as ee}from"./TablePagination-096da408.js";import{C as se}from"./Card-15cadf45.js";import"./apply-pagination-03aa54c3.js";import"./apply-sort-95de74ec.js";import"./deep-copy-ee95be26.js";import"./data-ada0f0b8.js";import"./axios-instance-67182a36.js";import"./index-96e7fc06.js";import"./index-ecc76830.js";import"./index-71286f46.js";import"./index-078e6bc2.js";import"./KeyboardArrowRight-7b5ddf7b.js";const te=(s=[])=>{const[r,n]=a.useState([]);a.useEffect(()=>{n([])},[s]);const l=a.useCallback(()=>{n([...s])},[s]),p=a.useCallback(c=>{n(t=>[...t,c])},[]),d=a.useCallback(()=>{n([])},[]),u=a.useCallback(c=>{n(t=>t.filter(g=>g!==c))},[]);return{handleDeselectAll:d,handleDeselectOne:u,handleSelectAll:l,handleSelectOne:p,selected:r}},re=[{label:"All",value:"all"},{label:"Prospect",value:"isProspect"},{label:"Returning",value:"isReturning"}],ae=[{label:"Last update (newest)",value:"updatedAt|desc"},{label:"Last update (oldest)",value:"updatedAt|asc"},{label:"Total loans (highest)",value:"totalLoans|desc"},{label:"Total loans (lowest)",value:"totalLoans|asc"}],A=s=>{const{onFiltersChange:r,onSortChange:n,sortBy:l,sortDir:p}=s,d=a.useRef(null),[u,c]=a.useState("all"),[t,g]=a.useState({}),S=a.useCallback(()=>{r==null||r(t)},[t,r]);z(()=>{S()},[t,S]);const B=a.useCallback((h,m)=>{c(m),g(j=>{const y={...j,isProspect:void 0,isReturning:void 0};return m!=="all"&&(y[m]=!0),y})},[]),R=a.useCallback(h=>{h.preventDefault(),g(m=>{var j;return{...m,query:(j=d.current)==null?void 0:j.value}})},[]),O=a.useCallback(h=>{const[m,j]=h.target.value.split("|");n==null||n({sortBy:m,sortDir:j})},[n]);return e.jsxs(e.Fragment,{children:[e.jsx(H,{indicatorColor:"primary",onChange:B,scrollButtons:"auto",sx:{px:3},textColor:"primary",value:u,variant:"scrollable",children:re.map(h=>e.jsx(Q,{label:h.label,value:h.value},h.value))}),e.jsx(I,{}),e.jsxs(x,{alignItems:"center",direction:"row",flexWrap:"wrap",spacing:3,sx:{p:3},children:[e.jsx(v,{component:"form",onSubmit:R,sx:{flexGrow:1},children:e.jsx(L,{defaultValue:"",fullWidth:!0,inputProps:{ref:d},placeholder:"Search customers",startAdornment:e.jsx(E,{position:"start",children:e.jsx(f,{children:e.jsx(F,{})})})})}),e.jsx(M,{label:"Sort By",name:"sort",onChange:O,select:!0,SelectProps:{native:!0},value:`${l}|${p}`,children:ae.map(h=>e.jsx("option",{value:h.value,children:h.label},h.value))})]})]})};A.propTypes={onFiltersChange:i.func,onSortChange:i.func,sortBy:i.string,sortDir:i.oneOf(["asc","desc"])};const k=s=>{const{count:r=0,items:n=[],onPageChange:l=()=>{},onRowsPerPageChange:p,page:d=0,rowsPerPage:u=0,selected:c=[]}=s;return e.jsxs(v,{sx:{position:"relative"},p:2,children:[e.jsx(N,{children:e.jsxs(K,{sx:{minWidth:700},children:[e.jsx(Z,{children:e.jsxs(D,{children:[e.jsx(o,{children:"id"}),e.jsx(o,{children:"first_name"}),e.jsx(o,{children:"surname"}),e.jsx(o,{children:"address"}),e.jsx(o,{children:"telephone"}),e.jsx(o,{children:"gender"}),e.jsx(o,{children:"guarantors"}),e.jsx(o,{align:"right",children:"Actions"})]})}),e.jsx(X,{children:n.map(t=>{const g=c.includes(t.id);return e.jsxs(D,{hover:!0,selected:g,children:[e.jsx(o,{padding:"checkbox",children:t.id}),e.jsx(o,{children:e.jsx(x,{alignItems:"center",direction:"row",spacing:1,children:e.jsxs("div",{children:[e.jsx(w,{color:"inherit",component:C,href:b.dashboard.customers.details,variant:"subtitle2",children:t.first_name}),e.jsx(P,{color:"text.secondary",variant:"body2",children:t.email})]})})}),e.jsx(o,{children:t.surname}),e.jsx(o,{children:t.address}),e.jsx(o,{children:t.telephone}),e.jsx(o,{children:t.gender}),e.jsx(o,{children:e.jsx(x,{alignItems:"center",direction:"column",spacing:1,children:e.jsxs("div",{children:[e.jsx(w,{color:"inherit",component:C,href:b.dashboard.customers.details,variant:"subtitle2",children:t.guarantors?t.guarantors[0]:"NONE"}),e.jsx(P,{color:"text.secondary",variant:"body2",children:t.guarantors?t.guarantors[1]:"NONE"})]})})}),e.jsxs(o,{align:"right",children:[e.jsx(T,{component:C,href:b.dashboard.customers.edit,children:e.jsx(f,{children:e.jsx(J,{})})}),e.jsx(T,{component:C,href:b.dashboard.customers.details,children:e.jsx(f,{children:e.jsx(Y,{})})})]})]},t.id)})})]})}),e.jsx(ee,{component:"div",count:r,onPageChange:l,onRowsPerPageChange:p,page:d,rowsPerPage:u,rowsPerPageOptions:[5,10,25]})]})};k.propTypes={count:i.number,items:i.array,onDeselectAll:i.func,onDeselectOne:i.func,onPageChange:i.func,onRowsPerPageChange:i.func,onSelectAll:i.func,onSelectOne:i.func,page:i.number,rowsPerPage:i.number,selected:i.array};const ne=()=>{const[s,r]=a.useState({filters:{query:void 0,isProspect:void 0,isReturning:void 0},page:0,rowsPerPage:5,sortBy:"updatedAt",sortDir:"desc"}),n=a.useCallback(u=>{r(c=>({...c,filters:u}))},[]),l=a.useCallback(u=>{r(c=>({...c,sortBy:u.sortBy,sortDir:u.sortDir}))},[]),p=a.useCallback((u,c)=>{r(t=>({...t,page:c}))},[]),d=a.useCallback(u=>{r(c=>({...c,rowsPerPage:parseInt(u.target.value,10)}))},[]);return{handleFiltersChange:n,handleSortChange:l,handlePageChange:p,handleRowsPerPageChange:d,state:s}},oe=s=>{const r=G(),[n,l]=a.useState({customers:[],customersCount:0}),p=a.useCallback(async()=>{try{const d=await V.getCustomers(s);r()&&l({customers:d.data,customersCount:d.count})}catch(d){console.error(d)}},[s,r]);return a.useEffect(()=>{p()},[s]),{...n}},le=(s=[])=>a.useMemo(()=>s.map(r=>r.id),[s]),Re=()=>{const s=ne(),r=oe(s.state),n=le(r.customers),l=te(n);return $(),e.jsxs(e.Fragment,{children:[e.jsx(_,{title:"Dashboard: Customer List"}),e.jsx(v,{component:"main",sx:{flexGrow:1,py:8},children:e.jsx(W,{maxWidth:"xl",children:e.jsxs(x,{spacing:4,children:[e.jsxs(x,{direction:"row",justifyContent:"space-between",spacing:4,children:[e.jsx(x,{spacing:1,children:e.jsx(P,{variant:"h4",children:"Customers"})}),e.jsx(x,{alignItems:"center",direction:"row",spacing:3,children:e.jsx(q,{startIcon:e.jsx(f,{children:e.jsx(U,{})}),variant:"contained",children:"Add"})})]}),e.jsxs(se,{children:[e.jsx(A,{onFiltersChange:s.handleFiltersChange,onSortChange:s.handleSortChange,sortBy:s.state.sortBy,sortDir:s.state.sortDir}),e.jsx(k,{count:r.customersCount,items:r.customers,onDeselectAll:l.handleDeselectAll,onDeselectOne:l.handleDeselectOne,onPageChange:s.handlePageChange,onRowsPerPageChange:s.handleRowsPerPageChange,onSelectAll:l.handleSelectAll,onSelectOne:l.handleSelectOne,page:s.state.page,rowsPerPage:s.state.rowsPerPage,selected:l.selected})]})]})})})]})};export{Re as default};
